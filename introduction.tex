%!TEX root = kdv.tex

\section{Introduction}

The \KdV equation first appeared in 1895 in the context of water waves, cf. \cite{korteweg1895xli}. It is designed to model the evolution of long water waves in a channel of rectangular cross section when the effects of nonlinearity and dispersion balance. This phenomenon gives rise to the so-called soliton, a wave traveling at constant speed without losing its shape. This equation has been theoretically widely studied: much work has been devoted to the derivation of the equation from Euler equations, e.g. \cite{shen1992forced,constantin2008,su2003korteweg}, but also to the proof of its well-posedness in various contexts, cf. \cite{miura1976korteweg,kenig1993,bourgain1997periodic} (periodic domain, on the real line, bounded domain), to their controllability, see \cite{rosier1997exact,glass2008some,coron2003exact,chapouly2009global}.
%Because many applications were investigated, and in particular, numerous works in environmental sciences but also life sciences - see \cite{dauxois2006physics,whitham2011linear,Crepeau2007594,yomosa1987} and the references therein, lots of numerical methods have been developped to solve it efficiently \cite{trefethen2000spectral,shen2003new,ma2000legendre}.
One application of the \KdV equation, which is of particular interest for us, is the modeling of a flow in a narrow channel over an obstacle, cf. \cite{milewski2004forced,shen1992forced,shen1996accuracy}. % be it more particularly a water wave over rocks or an atmospheric flow over a topographic obstacle \cite{baines1997topographic}.
In that case, a source term is added to the right-hand side of the \KdV equation, which represents the spatial derivative of the topography under the flow. The resulting equation is called the forced \KdV equation. More generally, we consider the forced \KdVB (\KdV-Burgers) equation which describes the viscous flow over a topography. This is done on the one hand to include viscosity and on the other hand for mathematical reasons.      %Considering the various rescalings and asymptotics involved in the derivation of the \KdV equation, it is a reasonable assumption to model its effect by a Dirac delta function in space \cite{shen1996accuracy, shen2000bumpdirac}.
In this paper we propose a framework which can be used for two kinds of problems regarding the \KdVB equation. We investigate an inverse problem in which we intend to reconstruct a time varying bottom topography, e.g., the locations of bumps with time-dependent height on the bottom of the channel, from noisy observations of the generated wave patterns. Secondly, we consider a control problem in which we want to create a certain desired flow by changing the topography under the flow. {\color{red} In this article, we consider a topography which is piecewise constant and has jumps with time varying heights. Thus its derivative is a linear combination of Dirac measures with time-independent positions $x_i$ and time-dependent magnitudes $u_i$, i.e.,
\begin{equation}\label{lin comb dirac}
\sum_{i=1}^{N}{u_{i}(t)\delta_{x_{i}}(x)}.
\end{equation}
Then the control problem consist of finding the optimal positions and optimal time-depending heights of the jumps given a desired water flow $z$. In the inverse problem, we reconstruct the positions and time-dependent heights of the jumps given given noisy measurements of the flow patterns $z$. As pointed out in \cite{pieper2014} and \cite{KunischTrautmannVexler14} the space of vector measures $\M$ with values in $L^2(I)$ contains sources of the form \eqref{lin comb dirac} and the use of its norm $\|\cdot\|_{\M}$ as control cost functional enhances optimal controls with a small spatial support, i.e. controls of the form \eqref{lin comb dirac}. In this perspective, we follow the path introduced in \cite{pieper2014,KunischTrautmannVexler14} and introduce a measure-valued optimal control problem posed in the space $\M$ for the approximative solution of the mentioned optimal control and inverse problem.} In particular, we focus on the optimal control problem
\begin{multline}
\min_{u \in \M, y\in Y}J(y,u)=\frac{1}{2}\left(\norm{\chi_{\Omega_{o}}y - z_1}_{L^2(I\times \Omega_{o})}^2+\|\chi_{\Omega_{o}}y(T)-z_2\|_{L^2(\Omega_{o})}^2\right)\\
+ \alpha \norm{u}_{\mathcal{M}(\Omega_c, L^{2}(I))}
\label{cost}\tag{\ensuremath{\mathcal P}}
\end{multline}
with $(z_1,z_2)\in L^2(I\times \Omega_o)\times L^2(\Omega_o) $ where $y\in Y$ (the space $Y$ will be defined later on) is the solution of the \KdVB equation with homogenous Dirichlet and Neumann boundary conditions on $\Omega = (0,L)$:
\begin{subequations}
\begin{numcases}{}
\partial_t y +\partial_x y + \partial_{xxx} y + y\partial_x y -\gamma \partial_{xx} y=  u \mbox{ in } I\times\Omega,\label{kdvcontrol1}\\
y(\cdot,0) = y(\cdot,L) = \partial_x y (\cdot,L) = 0\mbox{ in } I,\label{kdvcontrol2}\\
y(0,\cdot) = y_0(\cdot) \mbox{ in } \Omega\label{kdvcontrol3}.
\end{numcases}
\end{subequations}
The control acts on the control domain $\Omega_c\subseteq \Omega$. The state variable $y$ is tracked on the observation domain $\Omega_{o}\subseteq\Omega$. The parameter $\alpha > 0$ is called control cost parameter and  $\gamma \geq 0$ viscosity parameter. {\color{red} Other boundary conditions, for example periodic ones, e.g. \cite{Bourgain93}, or exterior ones, e.g. \cite{BonaWinther83}, can be also prescribed in \eqref{kdvcontrol1}--\eqref{kdvcontrol3} instead of Dirichlet and Neumann boundary conditions. It appears not to be straight forward to extend our analysis to these boundary conditions, since, for example, compact embeddings are not available on unbounded domains.} %Denoting by $I=[0,T]$ the time horizon considered, the control variable $u$ lies in the space of Borel measures with values in $L^2(I)$ that we will denote $\M$.
%A crucial feature of our mathematical analysis is based on the fact that this space can be identified with the topological dual of $C_{0}(\Omega,L^2(I))$ \cite{clason2011duality,casas2012approximation}, i.e. the space of continuous functions with compact support in $\Omega$ and values in $L^2(I)$.
%To give an insight, $\M$ contains functions of the type $u(t,x) = \sum_{i=1}^{N}{u_{i}(t)\delta_{x_{i}}(x)}$, with $u_i \in L^2(I)$ and $\delta_{x_i}$ ard Dirac delta functions located at the fixed points $x_i$. But we want to stress that it does not include moving Dirac delta functions. Those functions would rather be elements of $L^2(I,\mathcal{M}(\Omega))$, with $\M \subset L^2(I,\mathcal{M}(\Omega))$.
Similar types of measure-valued control problems have already been studied in the case of linear elliptic and parabolic equations, see \cite{pieper2013priori,clason2011duality,casas2012approximation,ClasonKunisch:2011b} and \cite{casas2013parabolic,CasasZuazua13,CasasVexlerZuazua13,CasasKunisch15}. Our problem is connected to \cite{herzog2012directional} where the authors use the control cost functional
\[
u\mapsto\alpha \|u\|_{L^1(\Omega_c,L^2(I))}+\frac \varepsilon 2 \|u\|_{L^2(I\times \Omega_c)}^2
\]
in connection with parabolic optimal control problems. This control cost functional promotes sparsity patterns of the optimal control which are constant in time (directional sparsity, joint sparsity). Our problem setting is equivalent to theirs for $\varepsilon=0$. %Moreover we solve \eqref{cost} using a continuation strategy involving the the regularization term $(\varepsilon/2)\|\cdot\|_{L^2(I\times \Omega_c)}^2$ for $\varepsilon\rightarrow 0$.\\
%To the authors knowledge, optimal control of the Korteweg-de Vries-Burgers equation is still an open problem, especially in a sparsity promoting framework.
\\
The mathematical challenges of this work are twofold: On the one hand we prove time-global well-posedness of the state equation in the presence of an irregular source term and on the other hand sparse optimal control of a nonlinear dispersive partial differential equation is also a novel research topic.\\
{\color{red} The time-global wellposedness of \eqref{kdvcontrol1}--\eqref{kdvcontrol3} for $(u,y_0)\in \Hm1\times L^2(\Omega)$ plays a very important role in the analysis of \eqref{cost}. It is established in the non-viscous case $(\gamma=0)$ for small data $(u,y_0)$ and the viscous case $(\gamma>0)$ for general data. Based on these results concerning the state equation we establish the existence of an optimal control in two different scenarios, namely in the non-viscous case $\gamma=0$ with additional norm constraints $\|u\|_{\M}\leq \beta$ on the control and in the viscous case $\gamma>0$ for general controls. Then we derive necessary optimality conditions for \eqref{cost} in the non-viscous case with norm constraint on the control as well as in the viscous case for general controls. The derivation requires the analysis of the linearized \KdVB equation and of the adjoint linearized \KdVB equation. Therefore, we discuss their wellposedness and regularity properties. Additionally, we proof existence of controls in the non-viscous case $\gamma=0$ with general controls based on the non-reduced approach, cf. \cite{lions1985control}. This approach requires an additional regularization term for the state $y$ in the cost functional \eqref{cost}. Then we discuss the discretization of \eqref{cost} based on a Petrov-Galerkin method in space and the Crank-Nikolson-Leap-Frog method in time for \eqref{kdvcontrol1}--\eqref{kdvcontrol3}. In particular, we derive a suitable discrete adjoint state equation. For the algorithmical solution of \eqref{cost} we consider the viscous and non-viscous case without norm constraints on the control. Our strategy is based on an additional $L^2$-regularization in \eqref{cost} and a continuation strategy in the regularization parameter. The $L^2$-regularized problems are solved by a trust-region semi-smooth Newton method. We conclude with some numerical examples on the \KdVB equation, which include an inverse problem and a control problem.}
%We point out that the quantities $y$, $x$, and $t$ can be rescaled to produce any desired coefficients for the terms of \eqref{kdvcontrol1} - \eqref{kdvcontrol3}. The choice we make here is convenient for the mathematical analysis of the problem.

%%% OUTLINE
{\color{red} This paper is organized as follows. In \cref{control space} properties of the control space $\M$ are discussed. \Cref{secwellposedness} deals with the time-global wellposedness of \eqref{kdvcontrol1}--\eqref{kdvcontrol3}. In \cref{sec:ex opt} the existence of optimal controls is proven based on the state reduced approach. \Cref{secoptconditions} is concerned with the derivation of necessary optimality conditions of \eqref{cost}. In \cref{wp2} the existence of optimal controls in the non-viscous case $(\gamma=0)$ without additional control constraints based on non-reduced approach is shown. Finally, \cref{secnum} displays the numerical methods which are adopted for the solution of the state equation and of the optimization problem. The section is concluded with two numerical experiments.}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "kdv.tex"
%%% End:
